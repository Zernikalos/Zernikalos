package mr.robotto.ui

import android.opengl.GLES20
import android.opengl.GLSurfaceView
import mr.robotto.MrRenderingContext
import mr.robotto.components.MrViewport
import mr.robotto.loader.MrLoader
import mr.robotto.objects.MrModel
import mr.robotto.objects.MrObject
import javax.microedition.khronos.egl.EGLConfig
import javax.microedition.khronos.opengles.GL10

class MrRenderer: GLSurfaceView.Renderer {

    private val context: MrRenderingContext = MrRenderingContext()
    private val scene: MrViewport = MrViewport()

    override fun onSurfaceCreated(p0: GL10?, p1: EGLConfig?) {
        scene.initialize(context)

        val loader = MrLoader()
        val auto: MrObject = loader.load("826547726f7570a2646e616d6560686368696c6472656e8182654d6f64656ca4646e616d6560686368696c6472656e80646d657368a267696e6469636573806a61747472696275746573a368706f736974696f6ea5646e616d6568706f736974696f6e6473697a650365636f756e7418246464617461d8555901b000004842000048420000484200004842000048c2000048420000484200004842000048c200004842000048c20000484200004842000048c2000048c20000484200004842000048c2000048c200004842000048c2000048c2000048c2000048c2000048c20000484200004842000048c2000048c2000048c2000048c2000048c200004842000048c20000484200004842000048c200004842000048c2000048c200004842000048420000484200004842000048c2000048c200004842000048420000484200004842000048420000484200004842000048c2000048c2000048c200004842000048c2000048c2000048c200004842000048c200004842000048c2000048c2000048c200004842000048c2000048c200004842000048c200004842000048c20000484200004842000048c2000048c200004842000048420000484200004842000048c2000048c20000484200004842000048c2000048420000484200004842000048420000484200004842000048c200004842000048c2000048c2000048c200004842000048c200004842000048c2000048c2000048c2000048c2000048c2000048c200004842000048c265696e64657820666e6f726d616ca5646e616d65666e6f726d616c6473697a650365636f756e7418246464617461d8555901b00000803f00000000000000000000803f00000000000000000000803f00000000000000000000803f00000000000000000000803f00000000000000000000803f0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000000000000803f00000000000000000000803f00000000000000000000803f00000000000000000000803f00000000000000000000803f00000000000000000000803f0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000000000000803f00000000000000000000803f00000000000000000000803f00000000000000000000803f00000000000000000000803f00000000000000000000803f0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf0000000000000000000080bf65696e64657820627576a5646e616d656275766473697a650265636f756e7418246464617461d855590120000000000000803f00000000000000000000803f0000803f00000000000000000000803f000000000000803f0000803f000000000000803f00000000000000000000803f0000803f00000000000000000000803f000000000000803f0000803f000000000000803f00000000000000000000803f0000803f00000000000000000000803f000000000000803f0000803f000000000000803f00000000000000000000803f0000803f00000000000000000000803f000000000000803f0000803f000000000000803f00000000000000000000803f0000803f00000000000000000000803f000000000000803f0000803f000000000000803f00000000000000000000803f0000803f00000000000000000000803f000000000000803f0000803f65696e646578206d73686164657250726f6772616da36c766572746578536861646572a264747970656676657274657866736f757263657903002376657273696f6e203330302065730a0a2f2f20616e2061747472696275746520697320616e20696e7075742028696e2920746f206120766572746578207368616465722e0a2f2f2049742077696c6c207265636569766520646174612066726f6d2061206275666665720a696e207665633420615f706f736974696f6e3b0a756e69666f726d207665633420755f6f66667365743b0a0a2f2f20616c6c207368616465727320686176652061206d61696e2066756e6374696f6e0a766f6964206d61696e2829207b0a0a20202f2f20676c5f506f736974696f6e2069732061207370656369616c207661726961626c65206120766572746578207368616465720a20202f2f20697320726573706f6e7369626c6520666f722073657474696e670a20206d6174342070203d206d61743428312e333733373338373039373237333131332c20302c20302c20302c20302c20312e333834343731303433333937303535372c20302c20302c20302c20302c202d312e30323032303230323032303230322c202d312c20302c20302c202d322e303230323032303230323032303230332c2030293b0a20206d6174342076203d206d61743428312c20302c20302c20302c20302c20312c20302c20302c20302c20302c20312c20302c20302c20302c202d362c2031293b0a20206d617434206d203d206d617434282d302e32343630383935393635353533373730342c20302e383230373330333939363732333838372c20302e353135353938323137313432373838362c20302c202d302e393638383832343039393133393236352c202d302e32323238393431393731373239383939372c202d302e31303736333338383233333236363139342c20302c20302e30323635383534353134303836383835332c202d302e353236303431363231383531353539332c20302e383530303433313930353831303332352c20302c20302c20302c20302c2031293b0a2020676c5f506f736974696f6e203d20702a762a6d202a2028615f706f736974696f6e202b20755f6f6666736574293b0a7d0a6e667261676d656e74536861646572a2647479706568667261676d656e7466736f757263657901662376657273696f6e203330302065730a0a2f2f20667261676d656e74207368616465727320646f6e2774206861766520612064656661756c7420707265636973696f6e20736f207765206e6565640a2f2f20746f207069636b206f6e652e206d656469756d70206973206120676f6f642064656661756c742e204974206d65616e7320226d656469756d20707265636973696f6e220a707265636973696f6e206d656469756d7020666c6f61743b0a0a2f2f207765206e65656420746f206465636c61726520616e206f757470757420666f722074686520667261676d656e74207368616465720a6f75742076656334206f7574436f6c6f723b0a0a766f6964206d61696e2829207b0a20202f2f204a7573742073657420746865206f757470757420746f206120636f6e7374616e74207265646973682d707572706c650a20206f7574436f6c6f72203d207665633428302e352c20302e352c20302e352c2031293b0a7d0a6a61747472696275746573a0")
        val auto2: MrModel = auto.children[0] as MrModel
        // auto2.setupContext(context)
        auto2.initialize(context)
    }

    override fun onSurfaceChanged(p0: GL10?, width: Int, height: Int) {
        GLES20.glViewport(0, 0, width, height)
    }

    override fun onDrawFrame(p0: GL10?) {
        scene.render()
    }
}